{
  "description": "Layer boundary rules for ForgeLedger Test. Each layer defines a directory glob and a list of forbidden patterns to enforce clean architecture separation between API routes, business services, data repositories, and frontend components.",
  "layers": [
    {
      "name": "api_routes",
      "description": "HTTP presentation layer -- parse requests, validate input, call services, return responses. No business logic, no direct DB access, no raw SQL.",
      "glob": "backend/app/api/routes/*.py",
      "forbidden": [
        {
          "pattern": "asyncpg",
          "reason": "Database access belongs in repositories, not API routes"
        },
        {
          "pattern": "psycopg",
          "reason": "Database access belongs in repositories, not API routes"
        },
        {
          "pattern": "\\bSELECT\\b.*\\bFROM\\b",
          "reason": "Raw SQL queries belong in repositories, not API routes"
        },
        {
          "pattern": "\\bINSERT\\s+INTO\\b",
          "reason": "Raw SQL statements belong in repositories, not API routes"
        },
        {
          "pattern": "\\bUPDATE\\s+\\w+\\s+SET\\b",
          "reason": "Raw SQL updates belong in repositories, not API routes"
        },
        {
          "pattern": "\\bDELETE\\s+FROM\\b",
          "reason": "Raw SQL deletes belong in repositories, not API routes"
        },
        {
          "pattern": "BEGIN\\s+TRANSACTION|COMMIT|ROLLBACK",
          "reason": "Transaction management belongs in repositories or services, not API routes"
        },
        {
          "pattern": "def calculate_.*balance|def compute_.*total",
          "reason": "Business calculations belong in services, not API routes"
        },
        {
          "pattern": "def validate_.*transaction|def check_.*category",
          "reason": "Complex business validation belongs in services, not API routes"
        }
      ]
    },
    {
      "name": "services",
      "description": "Business logic layer -- transaction processing, category management, balance calculations, validation rules. No direct DB access, no HTTP framework imports, no raw SQL.",
      "glob": "backend/app/services/*.py",
      "forbidden": [
        {
          "pattern": "asyncpg",
          "reason": "Database access belongs in repositories, not services"
        },
        {
          "pattern": "psycopg",
          "reason": "Database access belongs in repositories, not services"
        },
        {
          "pattern": "\\bSELECT\\b.*\\bFROM\\b",
          "reason": "Raw SQL queries belong in repositories, not services"
        },
        {
          "pattern": "\\bINSERT\\s+INTO\\b",
          "reason": "Raw SQL statements belong in repositories, not services"
        },
        {
          "pattern": "\\bUPDATE\\s+\\w+\\s+SET\\b",
          "reason": "Raw SQL updates belong in repositories, not services"
        },
        {
          "pattern": "\\bDELETE\\s+FROM\\b",
          "reason": "Raw SQL deletes belong in repositories, not services"
        },
        {
          "pattern": "fastapi\\.(Request|Response|APIRouter)",
          "reason": "HTTP framework imports belong in API routes, not services"
        },
        {
          "pattern": "from fastapi import",
          "reason": "HTTP framework dependencies belong in API routes, not services"
        },
        {
          "pattern": "\\.execute\\(|cursor\\.",
          "reason": "Direct database cursor operations belong in repositories, not services"
        }
      ]
    },
    {
      "name": "repositories",
      "description": "Data access layer -- database queries, transactions, CRUD operations only. No business logic, no HTTP framework imports, no business validation.",
      "glob": "backend/app/repositories/*.py",
      "forbidden": [
        {
          "pattern": "fastapi\\.(Request|Response|APIRouter)",
          "reason": "HTTP framework imports belong in API routes, not repositories"
        },
        {
          "pattern": "from fastapi import",
          "reason": "HTTP framework dependencies belong in API routes, not repositories"
        },
        {
          "pattern": "def calculate_.*balance|def compute_.*total",
          "reason": "Business calculations belong in services, not repositories"
        },
        {
          "pattern": "def validate_.*amount|def check_.*category_usage",
          "reason": "Business validation belongs in services, not repositories"
        },
        {
          "pattern": "if.*balance.*<|if.*total.*>",
          "reason": "Business logic conditions belong in services, not repositories"
        }
      ]
    },
    {
      "name": "models",
      "description": "Data models and schemas -- Pydantic models, database models, type definitions only. No business logic, no database operations, no HTTP handling.",
      "glob": "backend/app/models/*.py",
      "forbidden": [
        {
          "pattern": "\\bSELECT\\b.*\\bFROM\\b",
          "reason": "Database queries belong in repositories, not models"
        },
        {
          "pattern": "\\bINSERT\\s+INTO\\b",
          "reason": "Database operations belong in repositories, not models"
        },
        {
          "pattern": "asyncpg|psycopg",
          "reason": "Database client imports belong in repositories, not models"
        },
        {
          "pattern": "fastapi\\.APIRouter",
          "reason": "HTTP routing belongs in API routes, not models"
        },
        {
          "pattern": "def calculate_|def process_|def validate_",
          "reason": "Business logic methods belong in services, not models"
        },
        {
          "pattern": "\\.execute\\(|\\.fetch",
          "reason": "Database operations belong in repositories, not models"
        }
      ]
    },
    {
      "name": "frontend_components",
      "description": "UI presentation layer -- React components for display and user interaction only. No direct API calls, no business logic, no data fetching.",
      "glob": "frontend/src/components/**/*.{tsx,ts}",
      "forbidden": [
        {
          "pattern": "fetch\\(|axios\\.|http\\.",
          "reason": "API calls belong in API client services, not components"
        },
        {
          "pattern": "async.*fetch|await.*axios",
          "reason": "Data fetching belongs in API client services, not components"
        },
        {
          "pattern": "localStorage\\.setItem.*token",
          "reason": "Auth token management belongs in auth services, not components"
        },
        {
          "pattern": "def calculate_.*balance|const.*total.*=.*reduce",
          "reason": "Complex calculations belong in services or hooks, not presentation components"
        },
        {
          "pattern": "\\.toFixed\\(2\\).*\\+.*\\.toFixed\\(2\\)",
          "reason": "Financial calculations belong in services or utility functions, not components"
        }
      ]
    },
    {
      "name": "frontend_services",
      "description": "Frontend API client layer -- HTTP calls to backend, request/response handling. No UI rendering, no business logic, no state management.",
      "glob": "frontend/src/services/**/*.{ts,tsx}",
      "forbidden": [
        {
          "pattern": "import.*React.*from|import.*useState|import.*useEffect",
          "reason": "React hooks belong in components or custom hooks, not API services"
        },
        {
          "pattern": "return.*<.*>|JSX\\.Element",
          "reason": "UI rendering belongs in components, not API services"
        },
        {
          "pattern": "def calculate_.*balance|const.*total.*=.*reduce",
          "reason": "Business calculations belong in business logic layer or utilities, not API services"
        },
        {
          "pattern": "localStorage\\.getItem|sessionStorage\\.",
          "reason": "Storage access should be abstracted in storage utilities, not mixed with API calls"
        }
      ]
    },
    {
      "name": "frontend_hooks",
      "description": "Frontend state management layer -- custom React hooks for data fetching and state. No direct API URLs, no business calculations, no UI rendering.",
      "glob": "frontend/src/hooks/**/*.{ts,tsx}",
      "forbidden": [
        {
          "pattern": "fetch\\(.*http|axios\\.get\\(.*http",
          "reason": "API calls with hardcoded URLs belong in API services, not hooks"
        },
        {
          "pattern": "return.*<.*>|JSX\\.Element",
          "reason": "UI rendering belongs in components, not hooks"
        },
        {
          "pattern": "\\.toFixed\\(2\\).*[+\\-*/].*\\.toFixed\\(2\\)",
          "reason": "Complex financial calculations belong in utility functions, not hooks"
        },
        {
          "pattern": "const.*amount.*=.*parseFloat.*[+\\-].*parseFloat",
          "reason": "Business logic calculations belong in services or utilities, not hooks"
        }
      ]
    }
  ],
  "known_violations": []
}